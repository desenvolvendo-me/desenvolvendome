<div class="container container-intests-new">
  <div class="center-block">
    <div class="col-md-12 mx-auto">
      <div class="card card-signin">
        <div class="col-md-12 mx-auto">
          <%= search_form_for @q, url: compare_new_path do |f| %>
            <div class="row">
              <div class="col-md-2">
                <%= f.search_field :name_cont, placeholder: "Nome", class: "form-control mb-1 mr-1" %>
              </div>
              <div class="col-md-2">
                <%= f.search_field :login_cont, placeholder: "Login Github", class: "form-control mb-1 mr-1" %>
              </div>
              <div class="col-md-2">
                <%= f.select :profile_evaluation_evaluation_type_eq,
                             Evaluation.evaluation_types.to_a.map {|w| [enum_i18n(Evaluation, "evaluation_type", w[0]), w[1]]}, {:include_blank => true, prompt: 'Tipo'}, class: "form-control mb-1 mr-1" %>
              </div>
              <div class="col-md-2">
                <%= f.select :profile_evaluation_level_eq, [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], {:include_blank => true, prompt: 'Nível'}, class: "form-control mb-1 mr-1" %>
              </div>
              <div class="col-md-2">
                <%= f.submit "Pesquisar", class: "form-control mb-1 mr-1 btn btn-success" %>
              </div>
              <div class="col-md-2">
                <%= link_to "Cancelar", request.path, class: "form-control mb-1 mr-1 btn btn-info" %>
              </div>
            </div>
          <% end %>
        </div>
      </div>
      <hr class="featurette-divider">
      <div class="row justify-content-center">
        <%= paginate @users %>
      </div>
      <div class="row justify-content-center">
        <%= page_entries_info @users %>
      </div>
      <div class="row">
        <% @users.where.not(id: current_user.try(:id)).each do |user| %>
          <div class="col-md-3">
            <div class="list-group-item list-group-item-action flex-column align-items-start">
              <% if user %>
                <%= link_to user_path(user.login) do %>
                  <div class="d-flex w-100 justify-content-between">
                    <div class="h6 text-center">
                      <strong><%= user.profile.try(:evaluation).try(:evaluation_type) ? enum_i18n(Evaluation, "evaluation_type", user.profile.try(:evaluation).try(:evaluation_type)) : "?" %></strong>
                    </div>
                    <div class="h6 text-center">
                      <i class="fas fa-trophy"> <%= user.profile.try(:evaluation).try(:level) ? "#{user.profile.try(:evaluation).try(:level)}º nível" : "?" %></i>
                    </div>
                  </div>
                  <div class="d-flex w-100 justify-content-center">
                    <%= image_tag user.avatar, size: "150x150", class: "rounded-circle" %>
                  </div>
                  <div class="d-flex w-100 justify-content-start">
                    <div class="h4"><%= user.try(:name) ? truncate(user.try(:name), length: 20) : "?" %></div>
                  </div>
                <% end %>

                <div class="d-flex w-100 justify-content-end">
                  <div class="h6">
                    <%= link_to "https://github.com/#{user.try(:login)}", target: "_blank" do %>
                      <i class="fab fa-github"></i>
                      <%= user.try(:login) ? "@#{user.try(:login)}" : "?" %>
                    <% end %>
                  </div>
                </div>
                <% if current_user %>
                  <div class="d-flex w-100 justify-content-center mb-2">
                    <%= link_to compare_path(user: current_user.login, compared: user.login), class: "btn btn-outline-warning" do %>
                      <i class="fas fa-not-equal"> Comparar</i>
                    <% end %>
                  </div>
                <% end %>
              <% else %>
                <%= image_tag "user.png", size: "150x150", class: "profile-image rounded-circle" %>
              <% end %>
            </div>
            <br>
          </div>
        <% end %>
      </div>
      <div class="row justify-content-center">
        <%= paginate @users %>
      </div>
    </div>
  </div>
</div>