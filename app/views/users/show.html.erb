<div class="bg-perfil">
</div>
<div class="container container-profile">
  <div class="center-block">
    <div class="row">
      <div class="col-md-12">
        <div class="image-container text-center">
          <% if @user %>
            <%= image_tag @user.avatar, size: "150x150", class: "profile-image" %>
          <% else %>
            <%= image_tag "user.png", size: "150x150", class: "profile-image" %>
          <% end %>
          <div class="progress">
            <% if @user.try(:profile) %>
              <div class="progress-bar" role="progressbar" style="width: <%= progress_bar(@user) %>%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">Importado <%= number_to_percentage(progress_bar(@user), precision: 0) %></div>
            <% end %>
          </div>
          <p class="score-container">
            <% if @user.profile.try(:evaluation) %>
            <h4 class="text-center"><%= t("enum.evaluation_type.#{@user.profile.try(:evaluation).try(:evaluation_type)  }") %></h4>
            <h6 class="text-center"><%= "#{@user.profile.try(:evaluation).try(:level)}º nível" %></h6>
          <% else %>
            <h5>? (?º nível)</h5>
          <% end %>
          <% if @user.try(:profile) %>
            <span class="score-value btn btn-primary"><%= @user.profile.score.to_i %> xp</span>
          <% else %>
            <span class="score-value btn btn-primary">?</span>
          <% end %>
          </p>
        </div>
        <h4 class="text-info">Próximo Nível</h4>
        <div class="progress">
          <% if @user.try(:profile) %>
            <div class="progress-bar bg-success progress-bar-striped progress-bar-animated" role="progressbar" style="width: <%= next_level_bar(@user)[:percentage] %>%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"><%= next_level_bar(@user)[:number] %></div>
          <% end %>
        </div>
        <div class="profile-info">
          <div class="info">
            <p class="name"><%= @user.try(:name) %></p>
            <p class="login">
              <a href="https://github.com/<%= @user.try(:login) %>" title="<%= @user.try(:login) %>" target="_new">@<%= @user.try(:login) %></a>
            </p>
            <p class="bio"><span><%= @user.try(:bio) %></span></p>
          </div>
        </div>
      </div>
    </div>
    <% if @user.try(:profile) %>
      <% if progress_bar(@user) == 100 %>

        <hr class="featurette-divider">
        <div class="row">
          <div class="col-lg-12 text-center">
            <h3>SEUS PROJETOS</h3>
            <p class="text-info">A experiência é medida com base na quantidade de código criado. Não gostou? leia a nota <a href="#nota">clique aqui</a> </p>
          </div>
        </div>
        <div class="row">
          <div class="col-md-4">
            <div class="list-group">
              <a href="#" class="list-group-item list-group-item-action flex-column align-items-start">
                <div class="d-flex w-100 justify-content-between">
                  <h5 class="mb-1">Menos de 50 commits</h5>
                  <small>Perfil Iniciado</small>
                </div>
                <% if @user %>
                  <small class="text-muted">Você tem
                    <strong><%= @user.repositories.where("commits_count < 50").count %></strong>
                    repositórios.
                  </small>
                <% else %>
                  <small class="text-muted">Você tem 0 repositórios</small>
                <% end %>
              </a>
            </div>
          </div>
          <div class="col-md-4">
            <div class="list-group">
              <a href="#" class="list-group-item list-group-item-action flex-column align-items-start">
                <div class="d-flex w-100 justify-content-between">
                  <h5 class="mb-1">Entre 50 e 100 commits</h5>
                  <small>Perfil Aprendiz</small>
                </div>
                <% if @user %>
                  <small class="text-muted">Você
                    tem
                    <strong><%= @user.repositories.where("commits_count > 50 and commits_count < 100").count %></strong>
                    repositórios
                  </small>
                <% else %>
                  <small class="text-muted">Você tem 0 repositórios</small>
                <% end %>
              </a>
            </div>
          </div>
          <div class="col-md-4">
            <div class="list-group">
              <a href="#" class="list-group-item list-group-item-action flex-column align-items-start">
                <div class="d-flex w-100 justify-content-between">
                  <h5 class="mb-1">Mais de 100 commits</h5>
                  <small>Perfil Cavaleiro</small>
                </div>
                <% if @user %>
                  <small class="text-muted">Você tem
                    <strong><%= @user.repositories.where("commits_count > 100").count %></strong>
                    repositórios
                  </small>
                <% else %>
                  <small class="text-muted">Você tem 0 repositórios</small>
                <% end %>
              </a>
            </div>
          </div>
        </div>
        <hr class="featurette-divider">
        <div class="row">
          <div class="col-lg-12 text-center">
            <h3>SUAS LINGUAGENS</h3>
            <p class="text-info">A experiência é medida com base na quantidade de código criado. Não gostou? leia a nota <a href="#nota">clique aqui</a> </p>
          </div>
          <div class="col-md-3">
            <h5>Básicas</h5>
            <ul class="list-group">
              <% @user.profile.knowledges.where(knowledge_type: :basic).each do |knowledge| %>
                <li class="list-group-item d-flex justify-content-between align-items-center">
                  <%= knowledge.language.description %>
                  <span class="badge badge-primary badge-pill"><%= knowledge.level %>º nível</span>
                </li>
              <% end %>
            </ul>
          </div>
          <div class="col-md-3">
            <h5>Normais</h5>
            <ul class="list-group">
              <% @user.profile.knowledges.where(knowledge_type: :normal).each do |knowledge| %>
                <li class="list-group-item d-flex justify-content-between align-items-center">
                  <%= knowledge.language.description %>
                  <span class="badge badge-primary badge-pill"><%= knowledge.level %>º nível</span>
                </li>
              <% end %>
            </ul>
          </div>
          <div class="col-md-3">
            <h5>Raras</h5>
            <ul class="list-group">
              <% @user.profile.knowledges.where(knowledge_type: :rare).each do |knowledge| %>
                <li class="list-group-item d-flex justify-content-between align-items-center">
                  <%= knowledge.language.description %>
                  <span class="badge badge-primary badge-pill"><%= knowledge.level %>º nível</span>
                </li>
              <% end %>
            </ul>
          </div>
          <div class="col-md-3">
            <h5>Especiais</h5>
            <ul class="list-group">
              <% @user.profile.knowledges.where(knowledge_type: :special).each do |knowledge| %>
                <li class="list-group-item d-flex justify-content-between align-items-center">
                  <%= knowledge.language.description %>
                  <span class="badge badge-primary badge-pill"><%= knowledge.level %>º nível</span>
                </li>
              <% end %>
            </ul>
          </div>
        </div>
        <hr class="featurette-divider">
        <div class="row">
          <div class="col-lg-12 text-center">
            <h3>Seu XP é <%= @user.profile.score.to_i %> xp!</h3>
            <p>Quer saber como aumentar sua experiêncie?</p>
            <p><%= link_to "Clique Aqui", new_interest_path, class: "btn btn-lg btn-primary" %></p>
          </div>
        </div>
        <hr class="featurette-divider">
        <div class="row">
          <div class="col-lg-12 text-center">
            <code id="nota">
              <h3>NOTA</h3>
              <p>Ainda não levamos em consideração a Relevância e a Qualidade do código, somente a Quantidade.</p>
              <p>Nosso objetivo é disponibilizar na versão v1.1 e v1.2 respectivamente, hoje estamos na
                v0.2</p>
            </code>
          </div>
        </div>
      <% end %>
    <% end %>
  </div>
</div>
